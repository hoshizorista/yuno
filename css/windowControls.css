body {
  --control-space-top: 0px;
  --control-space-left: 75px; /* Default space for new buttons */
  --control-space-right: 12px; /* Default small padding */
}
/* window drag regions */

.window-drag-area {
  display: none;
}

body.windows:not(.maximized):not(.fullscreen):not(.separate-titlebar),
body.linux:not(.maximized):not(.fullscreen):not(.separate-titlebar) {
  --control-space-top: 12px;
}

/* On Windows, draggable regions aren't clickable, so the drag region is a separate area above the tabstrip */
body.windows:not(.maximized):not(.fullscreen):not(.separate-titlebar) .window-drag-area,
body.linux:not(.maximized):not(.fullscreen):not(.separate-titlebar) .window-drag-area {
  display: block;
  position: fixed;
  /* leave an empty space around the edges of the drag area so that the window can be resized */
  top: 3px;
  left: 3px;
  width: calc(100% - 6px);
  height: 12px;
  -webkit-app-region: drag;
}

body.mac:not(.separate-titlebar):not(.fullscreen) .window-drag-area {
  display: block;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 7px;
  -webkit-app-region: drag;
}

body.mac:not(.is-edit-mode):not(.fullscreen):not(.separate-titlebar) #mac-window-drag-area {
  margin-left: calc(var(--control-space-left) * -1);
  width: calc(var(--control-space-left) + 1.25em);
  height: 100%;
  -webkit-app-region: drag;
}

/* mac window buttons */

body.mac:not(.fullscreen):not(.separate-titlebar) {
  --control-space-left: 12px; /* Adjusted for padding within .caption-buttons */
}

body.rtl.mac:not(.fullscreen):not(.separate-titlebar) {
  --control-space-left: 0px; /* Keep RTL specific if needed, or unify */
  --control-space-right: 12px; /* Adjusted for padding within .caption-buttons */
}

/* macOS-style caption buttons */

.caption-buttons { /* Renamed from .windows-caption-buttons and made generic */
  display: flex;
  align-items: center;
  position: absolute;
  top: var(--control-space-top); /* Adjusted by platform specific rules for full screen etc. */
  left: var(--control-space-left);
  height: 36px; /* Standard navbar height */
  /* padding-left is handled by --control-space-left now for alignment with navbar content */
  z-index: 10;
  -webkit-app-region: no-drag; /* Ensure buttons are clickable */
}

.caption-button {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  margin-right: 8px;
  position: relative;
  cursor: default;
  -webkit-app-region: no-drag; /* Individual buttons also no-drag */
}

.button-close {
  background-color: #FF5F57;
}

.button-minimize {
  background-color: #FEBC2E;
}

.button-maximize {
  background-color: #28C840;
}

.caption-button:hover {
  filter: brightness(90%);
}

.caption-button:active {
  filter: brightness(80%);
}

/* Adjustments for specific platforms if they are not using separate titlebar */
/* Ensure new buttons show up, and old specific spacing is removed or adjusted */

body.windows:not(.maximized):not(.fullscreen):not(.separate-titlebar),
body.linux:not(.maximized):not(.fullscreen):not(.separate-titlebar) {
  /* --control-space-left is already 75px by default */
  /* --control-space-right is already 12px by default */
  /* No specific changes needed here if defaults are fine */
}


/* Hide old Windows specific styling if any remains */
.windows-caption-buttons .element {
  display: none;
}


/* Linux buttons (hidden via inline style in HTML for now) */

#linux-control-buttons {
  display: none;
}

body.linux:not(.separate-titlebar) {
  --control-space-right: 96px;
}

body.linux:not(.separate-titlebar) #linux-control-buttons {
  display: block;
  position: absolute;
  top: calc(9px + var(--control-space-top));
  right: 9px;
  z-index: 9;
  width: 76px;
}

body.task-overlay-is-shown #linux-control-buttons {
  color: black !important;
}

body.dark-mode.task-overlay-is-shown #linux-control-buttons {
  color: white !important;
}

#linux-control-buttons .button-background {
  fill: currentColor;
  stroke: currentColor;
  fill-opacity: 0;
  stroke-opacity: 0;
}

#linux-control-buttons g:hover .button-background {
  fill-opacity: 0.02;
  stroke-opacity: 0.09;
}

#linux-control-buttons g:active .button-background {
  fill-opacity: 0.18;
  stroke-opacity: 0.24;
}

.dark-theme #linux-control-buttons g:hover .button-background {
  fill-opacity: 0.2;
  stroke-opacity: 0.35;
}

.dark-theme #linux-control-buttons g:active .button-background {
  fill-opacity: 0.45;
  stroke-opacity: 0.7;
}
